<ng-container>
  <div class="buttons mb-4">
    <app-button
      [text]="'campsite.addLodging' | translate"
      (onClick)="openLodgingModal()"
    />
  </div>

  <div class="row m-0">
    <div
      *ngFor="let lodging of formArray.value"
      class="camping-lodging col-12 col-sm-6"
      (click)="openLodgingModal(lodging._id)"
    >
      <h4 class="fw-b">{{ lodging.name }}</h4>
      <span class="fs-sm">{{ lodging.type }}</span>
    </div>
  </div>

  <ng-template #popupTemplate>
    <ng-container *ngIf="page == 0">
      <div class="row">
        <div class="col-12 col-md-4 mb-4">
          <app-input-select
            [preText]="'common.type' | translate"
            [control]="actualLodging?.controls?.['type']"
            [options]="[
              { id: 'bungalow', name: 'campsite.bungalow' | translate },
              { id: 'campsite', name: 'campsite.campingArea' | translate },
              { id: 'other', name: 'common.other' | translate }
            ]"
          />
        </div>
        <div class="col-12 col-md-6 mb-4">
          <app-input-text
            [preText]="'common.name' | translate"
            [control]="actualLodging?.controls?.['name']"
          />
        </div>
      </div>

      <div class="row">
        <div class="col-12 col-md-4 mb-4">
          <app-input-text
            [preText]="'campsite.feePerNight' | translate"
            [control]="actualLodging?.controls?.['feePerNight']"
          />
        </div>
        <div class="col-12 col-md-4 mb-4">
          <app-input-text
            [preText]="'campsite.size' | translate"
            [control]="actualLodging?.controls?.['size']"
          />
        </div>
        <div class="col-12 col-md-4 mb-4">
          <app-input-text
            type="number"
            [preText]="'campsite.capacity' | translate"
            [control]="actualLodging?.controls?.['capacity']"
          />
        </div>
      </div>
    </ng-container>
    <ng-container *ngIf="page == 1">
      <div class="d-flex justify-content-between align-items-center">
        <app-input-text
          type="number"
          [preText]="'campsite.number' | translate"
          [(value)]="actualLodging?.controls?.['units'].value.length"
          [isDisabled]="true"
        />
        <app-button
          [text]="'common.add' | translate"
          (onClick)="handleAddUnit()"
          color="secondary"
          icon="add"
        />
      </div>
      <app-table [columns]="columns" [fetch]="handleGetUnits" [forceFetch]="tableRefreshFlag" [showPagination]="false"/>
    </ng-container>

    <div class="buttons mt-4">
      <app-button
        *ngIf="this.actualLodging.get('_id').value"
        [text]="'common.delete' | translate"
        color="danger"
        (onClick)="deleteCampingLodging()"
      />
      <app-button
        *ngIf="page == 1"
        color="secondary"
        [text]="'common.back' | translate"
        (onClick)="page = 0"
      />
      <app-button
        *ngIf="page == 0"
        [text]="'common.next' | translate"
        (onClick)="nextPage()"
      />
      <app-button
        *ngIf="page == 1"
        [text]="this.actualLodging.get('_id').value ? ('campsite.editLodging' | translate) : ('campsite.addLodging' | translate)"
        (onClick)="addCampingLodging()"
      />
    </div>
  </ng-template>
</ng-container>
